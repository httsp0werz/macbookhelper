# MBH CLI Utility

MBH — это CLI утилита для macOS, объединяющая функции очистки кеша, работы с 2FA и подключения к VPN через `tunblkctl`.

## Функциональные возможности

- **Очистка кеша:** Выполнение команд `dscacheutil -flushcache` и `killall -HUP mDNSResponder` с проверкой статуса.
- **2FA Меню:** Генерация и копирование TOTP кодов с использованием `oathtool`.
- **Подключение к VPN:** Просмотр списка VPN подключений, индикация состояния (подключён/отключён) с цветовым выделением, подключение и отключение через `tunblkctl`.

## Требования

- **macOS** (с Bash 3.2 по умолчанию)
- [Homebrew](https://brew.sh)
- Установленные пакеты:
  - `oath-toolkit` (для генерации 2FA кодов)
  - `tunblkct` (для управления VPN, [azhuchkov/tools/tunblkct](https://github.com/azhuchkov/tunblkctl))

### Однострочник для установки

```bash
curl -fsSL https://raw.githubusercontent.com/httsp0werz/macbookhelper/main/install.sh | bash
```

### Ручная установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/httsp0werz/macbookhelper.git
   cd mbh
   ```
2. Запустите скрипт установки:
   ```bash
   bash install.sh
   ```

После установки:
- Скрипт `mbh` будет скопирован в **/usr/local/bin/mbh** и доступен только для root (запускается с `sudo`).
- Файл `mbh.command` окажется в домашней директории пользователя и будет исполняемым.

## Использование

Запустите утилиту через spotlight:
```bash
mbh.command
```
Введите пароль su или приложите палец к считывателю

Появится меню с опциями:
- Очистка кеша
- 2FA Меню
- Подключение к VPN
- Добавление 2FA кода
- Выход


## Дополнительная рекомендация: Аутентификация по отпечатку пальца (Touch ID)

Для удобства использования sudo на macOS можно включить аутентификацию с помощью Touch ID.  
Проверьте, что в файле `/etc/pam.d/sudo` присутствует следующая строка:

```bash
auth       sufficient     pam_tid.so
```

Если этой строки нет, вы можете добавить её **в начало файла** `/etc/pam.d/sudo` с правами администратора (например, с помощью `sudo nano /etc/pam.d/sudo`). Это позволит использовать Touch ID вместо ввода пароля при выполнении команд через sudo.
